data1 = """
0a 01 00 09 00 30 02 00  05 7e f1 33 81 a5 63 68  .....0...~.3..ch
61 74 73 91 de 00 0c a2  69 64 00 a4 74 79 70 65  ats.....id..type
a6 44 49 41 4c 4f 47 a6  73 74 61 74 75 73 a6 41  .DIALOG.status.A
43 54 49 56 45 a5 6f 77  6e 65 72 d2 03 e2 5f c4  CTIVE.owner..._.
ac 70 61 72 74 69 63 69  70 61 6e 74 73 81 13 00  .participants...
f2 0d d3 00 00 01 9b 79  57 a0 0f ab 6c 61 73 74  .......yW...last
4d 65 73 73 61 67 65 de  00 07 a2 69 64 d3 19 00  Message....id...
75 16 11 a4 74 69 6d 65  29 00 01 6a 00 a3 a4 55  u...time)..j...U
53 45 52 a6 73 65 6e 64  5b 00 f1 2a a3 63 69 64  SER.send[..*.cid
d3 ff ff f8 fd b3 86 66  95 a4 74 65 78 74 da 05  .......f..text..
b2 36 39 20 32 65 20 36  66 20 36 65 20 36 35 20  .69 2e 6f 6e 65 
36 64 20 36 35 20 32 65  20 20 37 32 20 37 35 20  6d 65 2e  72 75 
33 61 20 33 34 03 00 f1  65 33 20 61 31 20 30 32  3a 34...e3 a1 02
20 20 69 2e 6f 6e 65 6d  65 2e 72 75 3a 34 34 33    i.oneme.ru:443
2e 2e 0a 30 35 20 32 64  20 62 37 20 34 39 20 38  ...05 2d b7 49 8
61 20 30 31 20 39 32 20  61 38 20 20 34 39 20 34  a 01 92 a8  49 4
65 20 34 36 20 34 66 20  35 32 20 34 64 20 34 35  e 46 4f 52 4d 45
20 35 32 20 20 2e 2d 2e  49 2e 2e 2e 2e 49 4e 46   52  .-.I....INF
4f 52 4d 45 52 0a 39 34  20 30 34 20 65 34 20 61  ORMER.94 04 e4 a
64 20 36 39 20 36 65 20  36 36 20 36 66 86 00 02  d 69 6e 66 6f...
93 00 f2 47 37 32 20 35  66 20 37 33 20 36 38 20  ...G72 5f 73 68 
36 66 20 20 2e 2e 2e 2e  69 6e 66 6f 72 6d 65 72  6f  ....informer
5f 73 68 6f 0a 37 37 20  39 36 20 30 31 20 30 36  _sho.77 96 01 06
20 31 36 20 30 30 20 30  30 20 31 66 20 20 30 35   16 00 00 1f  05
20 32 35 20 30 31 20 61  62 20 32 35 20 30 30 20   25 01 ab 25 00 
66 66 20 30 39 20 20 77  2e 2e 02 00 11 25 03 00  ff 09  w.....%..
a3 2e 0a 36 39 20 36 34  20 62 35 0c 01 21 37 37  ...69 64 b5..!77
73 00 21 39 20 19 01 13  31 83 00 f1 14 33 32 20  s.!9 ...1....32 
33 30 20 33 32 20 33 35  20 20 69 64 2e 6e 65 77  30 32 35  id.new
5f 79 65 61 72 5f 32 30  32 35 0a 35 66 20 36 31  _year_2025.5f 61
40 00 41 34 20 37 32 58  01 01 55 00 31 20 38 31  @.A4 72X..U.1 81
93 00 01 2b 01 53 63 33  20 32 32 12 00 f1 05 20  ...+.Sc3 22.... 
5f 61 6e 64 72 6f 69 64  2e 2e 2e 2d 2e 22 2e 2e  _android...-."..
0a 30 66 6a 01 01 b3 00  53 31 64 20 38 34 0f 00  .0fj....S1d 84..
f2 09 20 32 36 20 62 32  20 37 62 20 39 34 20 30  .. 26 b2 7b 94 0
35 20 34 33 20 63 64 20  30 31 0c 01 f1 00 2e 2e  5 43 cd 01......
2e 2e 26 2e 7b 2e 2e 43  2e 2e 0a 63 32 ed 00 71  ..&.{..C...c2..q
39 20 30 34 20 30 63 95  01 12 35 0c 01 44 33 20  9 04 0c...5..D3 
37 39 89 00 71 66 20 64  31 20 63 64 e2 00 32 2e  79..qf d1 cd..2.
2e 29 44 00 f3 01 79 2e  2e 2f 2e 2e 79 0a 30 30  .)D...y../..y.00
20 32 34 20 32 38 ad 00  02 36 00 63 31 38 20 20   24 28...6.c18  
65 31 43 00 23 33 36 80  00 f4 14 63 32 20 30 34  e1C.#36....c2 04
20 20 2e 24 28 2e 22 79  2e 2e 2e 79 2e 36 2e 2e    .$(."y...y.6..
2e 2e 0a 30 36 20 31 66  20 30 34 20 37 61 73 00  ...06 1f 04 7as.
86 65 20 64 36 20 20 39  66 13 00 b1 38 63 20 30  .e d6  9f...8c 0
37 20 66 33 20 30 33 c9  00 11 7a 87 00 02 06 00  7 f3 03...z.....
43 2e 0a 62 31 f0 01 51  37 33 20 37 34 8f 01 51  C..b1..Q73 74..Q
32 20 36 35 20 65 01 02  0c 02 41 31 20 36 32 65  2 65 e....A1 62e
01 f1 1c 63 20 36 39 20  20 2e 68 6f 73 74 5f 72  ...c 69  .host_r
65 61 63 68 61 62 69 6c  69 0a 37 34 20 37 39 20  eachabili.74 79 
37 33 20 30 31 20 31 32  20 38 61 20 37 63 6d 00  73 01 12 8a 7cm.
f1 05 33 35 20 33 36 20  63 61 20 34 30 20 37 37  ..35 36 ca 40 77
20 30 37 20 36 35 d5 01  f2 02 74 79 73 2e 2e 2e   07 65....tys...
7c 2e 35 36 2e 40 77 2e  65 35 0a 24 00 02 52 02  |.56.@w.e5.$..R.
f1 0c 30 30 20 64 66 20  30 33 20 65 32 20 20 61  ..00 df 03 e2  a
64 20 33 39 20 33 31 20  32 65 20 33 31 18 02 02  d 39 31 2e 31...
3d 03 21 2e 40 c7 00 f1  03 2e 2e 39 31 2e 31 30  =.!.@......91.10
35 2e 0a 33 31 20 33 36  20 33 38 2a 00 11 34 33  5..31 36 38*..43
00 b3 66 20 30 30 20 20  31 37 20 33 32 0d 00 41  ..f 00  17 32..A
31 37 20 33 b1 01 01 19  00 f3 06 36 38 2e 34 31  17 3.......68.41
2f 2e 2e 32 2f 2e 2e 34  2e 2e 0a 31 31 20 33 33  /..2/..4...11 33
1e 00 b1 30 33 20 34 33  20 30 37 20 31 31 c9 00  ...03 43 07 11..
f1 01 38 66 20 30 37 20  30 36 20 38 30 20 30 34  ..8f 07 06 80 04
20 32 ad 03 41 20 2e 33  2e 10 02 11 35 8d 00 71   2..A .3....5..q
23 2e 0a 33 61 20 31 ff  01 11 31 8f 00 02 0c 00  #..3a 1...1.....
61 30 33 20 20 38 65 40  00 41 30 20 37 38 ab 01  a03  8e@.A0 78..
41 66 20 64 33 9f 00 32  3a 2e 2e ce 01 32 2e 2e  Af d3..2:....2..
78 d5 01 01 e1 00 53 64  39 20 65 37 24 00 63 30  x.....Sd9 e7$.c0
66 20 63 36 20 5f 01 23  32 38 55 02 11 34 9b 02  f c6 _.#28U..4..
21 31 61 d5 01 03 02 00  81 28 2e 2e 4d 2e 2e 0a  !1a......(..M...
65 0b 04 84 30 31 20 31  36 20 65 31 2a 00 02 aa  e...01 16 e1*...
03 06 2b 02 41 66 20 65  61 ba 01 61 61 20 20 2e  ..+.Af ea..aa  .
4d 2e 3b 00 86 2e 7a 2e  2e 2f 2e 79 7a 9e 02 02  M.;...z../.yz...
89 00 03 36 00 51 62 20  20 63 37 89 00 43 36 20  ...6.Qb  c7..C6 
65 32 64 02 52 31 66 20  30 36 9e 02 04 57 02 53  e2d.R1f 06...W.S
7a 2e 2e 2e 0a 34 00 02  6a 00 34 62 20 33 46 00  z....4..j.4b 3F.
03 f7 02 05 7d 00 a1 30  30 20 30 39 20 62 61 20  ....}..00 09 ba 
20 7d 00 71 37 7a 2e 24  28 2e 79 43 00 f1 04 30   }.q7z.$(.yC...0
32 20 30 39 20 66 34 20  30 30 20 63 30 20 30 37  2 09 f4 00 c0 07
20 61 6a 02 61 20 36 35  20 37 33 ad 04 11 39 03   aj.a 65 73...9.
04 32 65 20 34 06 04 03  09 01 df 73 65 73 73 69  .2e 4......sessi
6f 6e 49 64 0a 30 62 20  01 00 1c f8 07 2e a8 61  onId.0b .......a
74 74 61 63 68 65 73 90  ad 6c 61 73 74 45 76 65  ttaches..lastEve
6e 74 54 fe 05 f3 11 b5  6c 61 73 74 44 65 6c 61  ntT.....lastDela
79 65 64 55 70 64 61 74  65 54 69 6d 65 00 b8 6c  yedUpdateTime..l
61 73 74 46 69 72 65 1b  00 51 45 72 72 6f 72 1a  astFire..QError.
00 f0 16 a7 63 72 65 61  74 65 64 01 a8 6a 6f 69  ....created..joi
6e 54 69 6d 65 01 a8 6d  6f 64 69 66 69 65 64 d3  nTime..modified.
00 00 01 9b 79 57 a0 0f                           ....yW..
"""
r = ""
for line in data1.strip().split("\n"):
    r += line[:48].replace(" ", "")
data1 = r

import lz4
import lz4.block
import msgpack
import json
from typing import Any


def _unpack_packet( data: bytes) -> dict[str, Any] | None:
    ver = int.from_bytes(data[0:1], "big")
    cmd = int.from_bytes(data[1:3], "big")
    seq = int.from_bytes(data[3:4], "big")
    opcode = int.from_bytes(data[4:6], "big")
    packed_len = int.from_bytes(data[6:10], "big", signed=False)
    comp_flag = packed_len >> 24
    payload_length = packed_len & 0xFFFFFF
    payload_bytes = data[10 : 10 + payload_length]


    payload = None
    if payload_bytes:
        if comp_flag != 0:
            compressed_data = payload_bytes
            try:
                payload_bytes = lz4.block.decompress(
                    compressed_data,
                    uncompressed_size=99999,
                )
            except lz4.block.LZ4BlockError:
                return None
        payload = msgpack.unpackb(payload_bytes, raw=False, strict_map_key=False)

    return {
        "ver": ver,
        "cmd": cmd,
        "seq": seq,
        "opcode": opcode,
        "payload": payload,
    }

data2 = bytes.fromhex(data1)
print(json.dumps(_unpack_packet(data=data2), indent=4, default=lambda x: x.hex() if isinstance(x, bytes) else str(x)))
